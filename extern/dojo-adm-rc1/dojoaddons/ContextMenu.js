/*
	Copyright (c) 2004-2008, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojoaddons.ContextMenu"]){dojo._hasResource["dojoaddons.ContextMenu"]=true;dojo.provide("dojoaddons.ContextMenu");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("dojoaddons.ContextMenu",[dijit._Widget,dijit._Templated],{templateString:"<div><div class=\"contextMenuTitle\" dojoattachpoint=\"titleNode\"></div><div class=\"contextMenuBody\" dojoattachpoint=\"bodyNode\"></div></div>",data:[],items:{},map:{},postCreate:function(){this.domNode.className="contextMenucontainer";dojo.body().appendChild(this.domNode);dojo.connect(this.domNode,"onmouseleave",this,"onContextLeave");dojo.connect(this.domNode,"onmouseenter",this,"onContextEnter");dojo.connect(this.domNode,"onclick",this,"closeContext");},setTitle:function(_1){this.titleNode.innerHTML=_1;},addItem:function(_2,_3,_4,id){var _6=dojo.doc.createElement("div");_6.className="contextMenuItem";_6.innerHTML=_2;_4=_4||[];this.map[id]=this.addItem.arguments;this.map[id].topic=_3;this.map[id].publishData=_4;this.map[id].connection=dojo.connect(_6,"onclick",function(_7){_4.push(_7);dojo.publish(_3,_4);});dojo.connect(_6,"onmouseover",function(){dojo.addClass(_6,"highlighted");});dojo.connect(_6,"onmouseout",function(){dojo.removeClass(_6,"highlighted");});this.bodyNode.appendChild(_6);this.map[id].domNode=_6;this.map[id].state="enabled";},onContextLeave:function(){this.contextTimer=window.setTimeout(dojo.hitch(this,"closeContext"),500);},onContextEnter:function(){this.clearTimer();},clearTimer:function(){if(this.contextTimer){window.clearTimeout(this.contextTimer);}},closeContext:function(){this.clearTimer();var _8=this.domNode;dojo.fadeOut({duration:200,node:_8,onEnd:function(){_8.style.zIndex=-1;}}).play();},getHeight:function(){var c=dojo.coords(this.domNode);console.log(c.h);var _a=c.h;return _a;},setClassName:function(_b,_c,_d){if(this.map[_b]){var _e=_d?"addClass":"removeClass";dojo[_e](this.map[_b].domNode,_c);}},toggleItem:function(id,_10){if(_10){this.enableItem(id);}else{this.disableItem(id);}},disableItem:function(id){if(this.map[id].state=="enabled"){dojo.disconnect(this.map[id].connection);this.map[id].state="disabled";this.setClassName(id,"disabled",true);}},enableItem:function(id){if(this.map[id].state=="disabled"){var _13=this.map[id].publishData;var _14=this.map[id].topic;this.map[id].connection=dojo.connect(this.map[id].domNode,"onclick",function(evt){_13.push(evt);dojo.publish(_14,_13);});this.map[id].state="enabled";this.setClassName(id,"disabled",false);}}});}